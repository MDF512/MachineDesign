% ---------------------------------------------------
% Homework template for USU courses
% Author: Michael Fretz
% ---------------------------------------------------

% ---------------------------------------------------
% Document Variables
% ---------------------------------------------------
\def \docTitle {Shaft Design Project Code} 
\def \due {28 January 2025}
\def \course {Machine Design MAE 4300}
\def \instructor {Professor Larry Gardner}


\documentclass[12pt]{article}
\usepackage{
    amsmath,
    amssymb,
    geometry,
    fancyhdr,
    tikzpagenodes,
    lipsum,
    lastpage,
    graphicx,
    titling,
    listings, 
    xcolor,
    float,
    siunitx,
    subcaption
}
\usepackage[us]{datetime}
\geometry{letterpaper, margin=1in}
\newdateformat{mydateformat}{
  \twodigit{\THEDAY} \space \shortmonthname[\THEMONTH] \THEYEAR
}

\fancypagestyle{first-page}{
    \fancyhf{}
    \fancyfoot[L]{A02369763}
    \fancyfoot[C]{ \thepage \space of \pageref{LastPage}} 
    \fancyfoot[R]{michael.fretz@usu.edu}
    \renewcommand{\headrulewidth}{0pt} 
    \renewcommand{\footrulewidth}{0.4pt} 
}

\fancypagestyle{default}{
    \fancyhead[R]{Michael Fretz \\ \docTitle}
    \fancyhead[L]{\course\\ \today}
    \fancyfoot[L]{A02369763}
    \fancyfoot[C]{ \thepage \space of \pageref{LastPage}}
    \fancyfoot[R]{michael.fretz@usu.edu}
    \renewcommand{\headrulewidth}{0.4pt}
    \renewcommand{\footrulewidth}{0.4pt}
    \setlength{\headheight}{27.18335pt}
    \addtolength{\topmargin}{-15.18335pt}
}

\definecolor{commentsColor}{rgb}{0.497495, 0.497587, 0.497464}
\definecolor{keywordsColor}{rgb}{0.250000, 0.000000, 0.558215}
\definecolor{stringColor}{rgb}{0.000000, 0.558215, 0.135316}

\lstset{ %
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\footnotesize,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{commentsColor}\textit,    % comment style      
  frame=tb,	                   	   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{keywordsColor}\bfseries,       % keyword style
  language=Python,                 % the language of the code (can be overrided per snippet)
  otherkeywords={*,...},           % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{commentsColor}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{stringColor}, % string literal style
  tabsize=1,	                   % sets default tabsize to 2 spaces
  title=\lstname,                  % show the filename of files included with \lstinputlisting; also try caption instead of title
  columns=fixed                    % Using fixed column width (for e.g. nice alignment)
}

\renewcommand\maketitlehookb{
    \vspace{-24 pt}
    \begin{center}
        \thebookdata
    \end{center}
    \vspace{-12 pt}
}

\setlength{\parindent}{0pt}

\fancypagestyle{last-page}{
    \fancyhead[R]{Michael Fretz \\ \docTitle}
    \fancyhead[L]{\course \\ \today}
    \fancyfoot[L]{A02369763 \\ michael.fretz@usu.edu}
    \fancyfoot[C]{ \\ \vspace{-6pt} \thepage \space of \pageref{LastPage}}
    \fancyfoot[R]{Last Saved At: \\ \mydateformat\today~at \currenttime}
    \renewcommand{\headrulewidth}{0.4pt} 
    \renewcommand{\footrulewidth}{0.4pt} 
}

\newcommand{\thebookdata}{Missing book data}
\newcommand{\bookdata}[2]{
  \renewcommand\thebookdata{{\large{#1}\par}#2}
}

\title{\docTitle}
\author{Tyler Black \\ Daniel Estes \\ Jonah Frederick\\ Mason Frederick \\ Michael Fretz\\ Travis Slade}

\bookdata{\course}{\instructor}
\date{Due: \due}

\pagestyle{default}
\AtEndDocument{\thispagestyle{last-page}}


\begin{document}
    \maketitle
    \vspace{-0.5in}
    \noindent
    \rule{\linewidth}{0.4pt}
    \thispagestyle{first-page}

   
    \section{Code}
    \lstinputlisting[language=Python]{shaft_design.py}
    
\end{document}